!function(a,b){function q(a,b){var c=a.previousSibling,d=a.nextSibling;c&&c.parentNode?c.parentNode.insertBefore(a,c.nextSibling):d&&d.parentNode?d.parentNode.insertBefore(a,d):b&&b.appendChild(a),a.style.display="none"==document.defaultView.getComputedStyle(a,null).display?"block":"none"}var i,j,k,o,h,p,r,c=document,d="querySelectorAll",e="getElementsByClassName",f=function(a){return c[d](a)},g={width:"80%",height:"50%",type:0,title:[],setType:"html",content:"\u8bf7\u7a0d\u7b49,\u6682\u65e0\u5185\u5bb9\uff01",conStyle:"background-color:#fff;",btnName:[],btnStyle:[],yesfun:null,nofun:null,closefun:null,closeBtn:[!0,1],time:null,fixed:!0,anim:!0,direction:["center","center"],mask:!0,maskClose:!0,maskColor:"#000",opacity:.5,margin:"5px 10px",zIndex:197e5,success:null};a.TOS={extend:function(a,c,d){d===b&&(d=!0);for(var e in c)!d&&e in a||(a[e]=c[e]);return a},touch:function(a,b){var c;a.addEventListener("touchmove",function(){c=!0},!1),a.addEventListener("touchend",function(a){a.preventDefault(),c||b.call(this,a),c=!1},!1)},timer:{},endfun:{}},h=Math.floor(9999999*Math.random()),p=function(a){var b=this,c=JSON.parse(JSON.stringify(g));b.config=TOS.extend(c,a),i=b.config.setType,j=b.config.content,"id"==i&&(k=f(j)[0],o=k.parentNode),b.view()},p.prototype={view:function(){var e,g,i,j,k,l,m,n,o,p,q,r,a=this,d=a.config;return e=d.mask?'<div class="modalmask" style="position:fixed;pointer-events:auto;background:'+d.maskColor+";opacity:"+d.opacity+'"></div>':"",g=function(){var c,a="object"==typeof d.title;return c=d.title[1]!=b?d.title[1]:"",""!=d.title?'<h3 class="modalhead" id="head'+h+'" style="'+c+'">'+(a?d.title[0]:d.title)+"</h3>":""}(),i="number"==typeof d.width?"width:"+d.width+"px;":"width:"+d.width+";",j="number"==typeof d.height?"height:"+d.height+"px;":"height:"+d.height+";",k=function(){var e,f,g,i,a=d.btnName,c=a.length;return 0!==c&&d.btnName?(1===c&&(f=""!=d.btnStyle?d.btnStyle[0]:"",e='<p ondg="1" style="'+f+'">'+a[0]+"</p>"),2===c&&(g=d.btnStyle[0],i=d.btnStyle[1]!=b?d.btnStyle[1]:"",e='<p ondg="0" style="'+i+'">'+a[1]+'</p><p ondg="1" style="'+g+'">'+a[0]+"</p>"),'<div class="modalfoot" id="foot'+h+'">'+e+"</div>"):""}(),""==d.direction?(alert("参数direction不能为空"),!1):(l="-webkit-box-align:"+d.direction[0]+";-webkit-box-pack:"+d.direction[1]+";",m=""+i+j+d.conStyle,n=e+'<div class="modalbox '+(d.anim?"modalanim":"")+'" style="'+m+'">'+g+'<span class="modalclose0'+d.closeBtn[1]+'" style="display:'+(d.closeBtn[0]?"block":"none")+'"></span>'+'<div class="modalcontent" id="conter'+h+'"></div>'+k+"</div>",f("body")[0].style.overflow="hidden",o=c.createElement("div"),a.id=o.id="modal"+h,o.setAttribute("class","modalpos"),o.setAttribute("style","z-index:"+d.zIndex+";"+l),o.innerHTML=n,c.body.appendChild(o),o.setAttribute("mob",h),p=a.elem=f("#"+a.id)[0],setTimeout(function(){try{p.className=p.className+" modalshow"}catch(a){return}d.success&&d.success(p)},1),q=""!=d.title?f("#head"+h)[0].offsetHeight:0,r=""!=d.btnName?f("#foot"+h)[0].offsetHeight:0,f("#conter"+h)[0].setAttribute("style","margin:"+d.margin+";top:"+q+"px;bottom:"+r+"px;"),a.index=h++,a.setconter(d),a.action(d,p),void 0)},setconter:function(b){var g,h,i,d=this,e=f("#conter"+d.index)[0];switch(b.setType){case"html":e.innerHTML=b.content;break;case"id":g=f(b.content)[0],h=c.createElement("div"),"none"==a.getComputedStyle(g,null).display&&(g.style.display="block"),i=h.appendChild(g),e.appendChild(i)}},action:function(a,b){var d,f,g,h,i,j,k,c=this;if(a.time&&(TOS.timer[c.index]=setTimeout(function(){r.close(c.index)},1e3*a.time)),a.closeBtn[0]&&(d=b[e]("modalclose0"+a.closeBtn[1])[0],f=function(){a.closefun&&a.closefun(),r.close(c.index)},TOS.touch(d,f),d.onclick=f),""!=a.btnName)for(g=function(){var b=this.getAttribute("ondg");0==b?(a.nofun&&a.nofun(),r.close(c.index)):a.yesfun?a.yesfun(c.index):r.close(c.index)},h=b[e]("modalfoot")[0].children,i=h.length,j=0;i>j;j++)TOS.touch(h[j],g),h[j].onclick=g;a.mask&&a.maskClose&&(k=b[e]("modalmask")[0],TOS.touch(k,function(){r.close(c.index,a.endfun)}),k.onclick=function(){r.close(c.index,a.endfun)}),a.endfun&&(TOS.endfun[c.index]=a.endfun)}},r={index:h,open:function(a){var b=new p(a||{});return b.index},close:function(a){var d,b=f("#modal"+a)[0];b&&("id"==i&&(d=f(j)[0],q&&(q(d,o),delete q)),f("body")[0].style.overflow="",b.innerHTML="",c.body.removeChild(b),clearTimeout(TOS.timer[h]),delete TOS.timer[h],"function"==typeof TOS.endfun[h]&&TOS.endfun[h](),delete TOS.endfun[h])},closeAll:function(){var b,d,a=c[e]("modalpos");for(b=0,d=a.length;d>b;b++)r.close(a[b].getAttribute("mob"))}},"function"==typeof define?define(function(){return r=m=$m=mDialog}):a.mc=m=$m=mDialog=r}(window);